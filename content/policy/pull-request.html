<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>代码提交指南</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <!-- Le styles -->
    <link href="../css/incubator.css" rel="stylesheet">
    <link href="../css/bootstrap.css" rel="stylesheet">
    <link href="../css/asciidoctor.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/prettify.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="https://www.apache.org/favicon.ico">
  </head>
  <body onload="prettyPrint()">
    <div id="wrap">
   

	<!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://doris.apache.org"><i class="icon-home"></i>Apache Doris</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documents <b class="caret"></b></a>
              <ul class="dropdown-menu">
                
                  <li><a href="http://doris.apache.org/guides/backup-restore.html">备份与恢复</a></li>
                
                  <li><a href="http://doris.apache.org/guides/deploy-upgrade.html">部署和升级</a></li>
                
                  <li><a href="http://doris.apache.org/guides/metadata-design.html">元数据设计文档</a></li>
                
                  <li><a href="http://doris.apache.org/guides/best-practices.html">最佳实践</a></li>
                
                  <li><a href="http://doris.apache.org/guides/documents.html">Doris 文档</a></li>
                
                  <li><a href="http://doris.apache.org/guides/monitor-alert.html">监控和报警</a></li>
                
                  <li><a href="http://doris.apache.org/guides/create-load-and-delete.html">建表、数据导入与删除</a></li>
                
                  <li><a href="http://doris.apache.org/guides/multi-tenant.html">多租户设计</a></li>
                
                  <li><a href="http://doris.apache.org/guides/data-model-rollup-prefix-index.html">数据模型和索引</a></li>
                
                  <li><a href="http://doris.apache.org/guides/install.html">安装文档</a></li>
                
                  <li><a href="http://doris.apache.org/guides/privilege.html">权限管理</a></li>
                
                  <li><a href="http://doris.apache.org/guides/sql_reference.html">SQL reference</a></li>
                
                  <li><a href="http://doris.apache.org/guides/getting-start.html">Tutorial</a></li>
                
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
              <ul class="dropdown-menu">
                
                  <li><a href="http://doris.apache.org/policy/contributing.html">如何做贡献</a></li>
                
                  <li><a href="http://doris.apache.org/policy/pull-request.html">代码提交指南</a></li>
                
                  <li><a href="http://doris.apache.org/policy/subscribe-mail-list.html">订阅邮件列表</a></li>
                
                  <li><a href="http://doris.apache.org/policy/use-gitter.html">Gitter 使用指南</a></li>
                
              </ul>
             </li> 

	    <li><a href="http://doris.apache.org/downloads.html">Downloads </a></li>
	    <li><a href="http://doris.apache.org/faq.html">FAQs </a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-md-4 vcenter"><a href="https://www.apache.org/"><img src="http://www.apache.org/img/asf_logo.png" alt="The Apache Software Foundation" border="0" style="margin-top: 2px" width="250"></a></div>
          <div class="col-md-4 vcenter"><a href="/"><img src="https://incubator.apache.org/images/incubator_feather_egg_logo_sm.png" alt="The Apache Software Foundation Incubator" border="0" style="margin-top: 2px" height="100"></a></div>
          <div class="col-md-4 vcenter"><a href="https://www.apache.org/foundation/contributing.html"><img src="https://www.apache.org/images/SupportApache-small.png" height="75" width="75"></a></div>
      </div>
    </div>
    <div class="top-container container">


<div class="page-header">
    <h1>代码提交指南</h1>
</div>

<p><p>在 <a href="https://github.com/apache/incubator-doris">Github</a> 上面可以很方便地提交 <a href="https://help.github.com/articles/about-pull-requests/">Pull Request (PR)</a>，下面介绍 Doris 项目的 PR 方法。</p> 
<h3><a href="#1-fork仓库" id="1-fork仓库">1. Fork仓库</a></h3> 
<p>进入 apache/incubator-doris 的 <a href="https://github.com/apache/incubator-doris">github 页面</a> ，点击右上角按钮 <code>Fork</code> 进行 Fork。</p> 
<p><img src="http://doris.apache.org/../images/fork-repo.png" alt="Fork"></p> 
<h3><a href="#2-配置git和提交修改" id="2-配置git和提交修改">2. 配置git和提交修改</a></h3> 
<h4><a href="#1将代码克隆到本地" id="1将代码克隆到本地">（1）将代码克隆到本地：</a></h4> 
<pre><code>git clone https://github.com/&lt;your_github_name&gt;/incubator-doris.git
</code></pre> 
<p>注意：请将 &lt;your_github_name&gt; 替换为您的 github 名字。</p> 
<p>clone 完成后，origin 会默认指向 github 上的远程 fork 地址。</p> 
<h4><a href="#2将-apacheincubator-doris-添加为本地仓库的远程分支-upstream" id="2将-apacheincubator-doris-添加为本地仓库的远程分支-upstream">（2）将 apache/incubator-doris 添加为本地仓库的远程分支 upstream：</a></h4> 
<pre><code>cd  incubator-doris
git remote add upstream https://github.com/apache/incubator-doris.git
</code></pre> 
<h4><a href="#3检查远程仓库设置" id="3检查远程仓库设置">（3）检查远程仓库设置：</a></h4> 
<pre><code>git remote -v
origin https://github.com/&lt;your_github_name&gt;/incubator-doris.git (fetch)
origin    https://github.com/&lt;your_github_name&gt;/incubator-doris.git (push)
upstream  https://github.com/apache/incubator-doris.git (fetch)
upstream  https://github.com/apache/incubator-doris.git (push)
</code></pre> 
<h4><a href="#4新建分支以便在分支上做修改" id="4新建分支以便在分支上做修改">（4）新建分支以便在分支上做修改：</a></h4> 
<pre><code>git checkout -b &lt;your_branch_name&gt;
</code></pre> 
<p>　　注意： &lt;your_branch_name&gt; 为您自定义的分支名字。</p> 
<p>　　创建完成后可进行代码更改。</p> 
<h4><a href="#5提交代码到远程分支" id="5提交代码到远程分支">（5）提交代码到远程分支：</a></h4> 
<pre><code>git commit -a -m "&lt;you_commit_message&gt;"
git push origin &lt;your_branch_name&gt;
</code></pre> 
<p>　　更多 git 使用方法请访问：<a href="https://www.atlassian.com/git/tutorials/setting-up-a-repository">git 使用</a>，这里不赘述。</p> 
<h3><a href="#3-创建pr" id="3-创建pr">3. 创建PR</a></h3> 
<h4><a href="#1新建-pr" id="1新建-pr">（1）新建 PR</a></h4> 
<p>在浏览器切换到自己的 github 页面，切换分支到提交的分支 &lt;your_branch_name&gt; ，点击 <code>New pull request</code> 按钮进行创建，如下图所示：</p> 
<p><img src="http://doris.apache.org/../images/new-pr.png" alt="new PR"></p> 
<h4><a href="#2准备分支" id="2准备分支">（2）准备分支</a></h4> 
<p>这时候，会出现 <code>Create pull request</code> 按钮，如果没有请检查是否正确选择了分支，也可以点击 “compare across forks” 重新选择 repo 和分支。</p> 
<p><img src="http://doris.apache.org/../images/create-pr.png" alt="create PR"></p> 
<h4><a href="#3填写-commit-message" id="3填写-commit-message">（3）填写 Commit Message</a></h4> 
<p>这里请填写 comment 的总结和详细内容，然后点击 <code>Create pull request</code> 进行创建。</p> 
<p>关于如何写 Commit Message，下面列出了一些 Tips：</p> 
<ul> 
 <li>请用英文 动词 + 宾语 的形式，动词不用过去式，语句用祈使句；</li> 
 <li>消息主题（Subject）和具体内容（Body）都要写，它们之间要有空行分割（GitHub PR界面上分别填写即可）。</li> 
 <li>消息主题长度不要超过<strong>50</strong>个字符；</li> 
 <li>消息内容每行不要超过 72 个字符，超过的需要手动换行；</li> 
 <li>消息内容用于解释做了什么、为什么做以及怎么做的。</li> 
</ul> 
<p>更详细的内容请参考 <a href="https://chris.beams.io/posts/git-commit">https://chris.beams.io/posts/git-commit</a></p> 
<p><img src="http://doris.apache.org/../images/create-pr2.png" alt="create PR"></p> 
<h4><a href="#4完成创建" id="4完成创建">（4）完成创建</a></h4> 
<p>创建成功后，您可以看到 Doris 项目需要 review，您可以等待我们 review 和合入，您也可以直接联系我们。</p> 
<p><img src="http://doris.apache.org/../images/create-pr3.png" alt="create PR"></p> 
<p>至此，您的PR创建完成，更多关于 PR 请阅读 <a href="https://help.github.com/categories/collaborating-with-issues-and-pull-requests/">collaborating-with-issues-and-pull-requests</a> 。</p> 
<h3><a href="#4-冲突解决" id="4-冲突解决">4. 冲突解决</a></h3> 
<p>　　提交PR时的代码冲突一般是由于多人编辑同一个文件引起的，解决冲突主要通过以下步骤即可：</p> 
<h4><a href="#1切换至主分支" id="1切换至主分支">（1）切换至主分支</a></h4> 
<pre><code>git checkout master
</code></pre> 
<h4><a href="#2同步远端主分支至本地" id="2同步远端主分支至本地">（2）同步远端主分支至本地</a></h4> 
<pre><code>git pull upstream master
</code></pre> 
<h4><a href="#3切换回刚才的分支假设分支名为fix" id="3切换回刚才的分支假设分支名为fix">（3）切换回刚才的分支（假设分支名为fix）</a></h4> 
<pre><code>git checkout fix
</code></pre> 
<h4><a href="#4进行rebase" id="4进行rebase">（4）进行rebase</a></h4> 
<pre><code>git rebase -i master
</code></pre> 
<p>此时会弹出修改记录的文件，一般直接保存即可。然后会提示哪些文件出现了冲突，此时可打开冲突文件对冲突部分进行修改，将提示的所有冲突文件的冲突都解决后，执行</p> 
<pre><code>git add .
git rebase --continue
</code></pre> 
<p>依此往复，直至屏幕出现类似 <em>rebase successful</em> 字样即可，此时您可以进行往提交PR的分支进行更新：</p> 
<pre><code>git push -f origin fix
</code></pre> 
<h3><a href="#5-一个例子" id="5-一个例子">5. 一个例子</a></h3> 
<h4><a href="#1对于已经配置好-upstream-的本地分支-fetch-到最新代码" id="1对于已经配置好-upstream-的本地分支-fetch-到最新代码">（1）对于已经配置好 upstream 的本地分支 fetch 到最新代码</a></h4> 
<pre><code>$ git branch
* master

$ git fetch upstream          
remote: Counting objects: 195, done.
remote: Compressing objects: 100% (68/68), done.
remote: Total 141 (delta 75), reused 108 (delta 48)
Receiving objects: 100% (141/141), 58.28 KiB, done.
Resolving deltas: 100% (75/75), completed with 43 local objects.
From https://github.com/apache/incubator-doris
   9c36200..0c4edc2  master     -&gt; upstream/master
</code></pre> 
<h4><a href="#2进行rebase" id="2进行rebase">（2）进行rebase</a></h4> 
<pre><code>$ git rebase upstream/master  
First, rewinding head to replay your work on top of it...
Fast-forwarded master to upstream/master.
</code></pre> 
<h4><a href="#3检查看是否有别人提交未同步到自己-repo-的提交" id="3检查看是否有别人提交未同步到自己-repo-的提交">（3）检查看是否有别人提交未同步到自己 repo 的提交</a></h4> 
<pre><code>$ git status
# On branch master
# Your branch is ahead of 'origin/master' by 8 commits.
#
# Untracked files:
#   (use "git add &lt;file&gt;..." to include in what will be committed)
#
#       custom_env.sh
nothing added to commit but untracked files present (use "git add" to track)
</code></pre> 
<h4><a href="#4合并其他人提交的代码到自己的-repo" id="4合并其他人提交的代码到自己的-repo">（4）合并其他人提交的代码到自己的 repo</a></h4> 
<pre><code>$ git push origin master
Counting objects: 195, done.
Delta compression using up to 32 threads.
Compressing objects: 100% (41/41), done.
Writing objects: 100% (141/141), 56.66 KiB, done.
Total 141 (delta 76), reused 140 (delta 75)
remote: Resolving deltas: 100% (76/76), completed with 44 local objects.
To https://lide-reed:fc35ff925bd8fd6629be3f6412bacee99d4e5f97@github.com/lide-reed/incubator-doris.git
   9c36200..0c4edc2  master -&gt; master
</code></pre> 
<h4><a href="#5新建分支准备开发" id="5新建分支准备开发">（5）新建分支，准备开发</a></h4> 
<pre><code>$ git checkout -b my_branch
Switched to a new branch 'my_branch'

$ git branch
  master
* my_branch
</code></pre> 
<h4><a href="#6代码修改完成后准备提交" id="6代码修改完成后准备提交">（6）代码修改完成后，准备提交</a></h4> 
<pre><code>$ git add -u
</code></pre> 
<h4><a href="#7填写-message-并提交到本地的新建分支上" id="7填写-message-并提交到本地的新建分支上">（7）填写 message 并提交到本地的新建分支上</a></h4> 
<pre><code>$ git commit -m "fix a typo"
[my_branch 55e0ba2] fix a typo
 1 files changed, 2 insertions(+), 2 deletions(-)
</code></pre> 
<h4><a href="#8将分支推到-github-远端自己的-repo-中" id="8将分支推到-github-远端自己的-repo-中">（8）将分支推到 GitHub 远端自己的 repo 中</a></h4> 
<pre><code>$ git push origin my_branch
Counting objects: 11, done.
Delta compression using up to 32 threads.
Compressing objects: 100% (6/6), done.
Writing objects: 100% (6/6), 534 bytes, done.
Total 6 (delta 4), reused 0 (delta 0)
remote: Resolving deltas: 100% (4/4), completed with 4 local objects.
remote: 
remote: Create a pull request for 'my_branch' on GitHub by visiting:
remote:      https://github.com/lide-reed/incubator-doris/pull/new/my_branch
remote: 
To https://lide-reed:fc35ff925bd8fd6629be3f6412bacee99d4e5f97@github.com/lide-reed/incubator-doris.git
 * [new branch]      my_branch -&gt; my_branch
</code></pre> 
<p>至此，就可以按照前面的流程进行创建 PR 了。</p></p>

		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
      <div class="container">
          <p class="muted credit">&copy; 2017 The Apache Software Foundation | Licensed under the Apache License, Version 2.0.<br/>
          Apache Incubator, Apache, the Apache feather logo, and the Apache Incubator project logo are trademarks of The Apache Software Foundation.</p>
      </div>
    </div>

    <script src="../js/jquery-1.11.1.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/prettify.js"></script>
    <script src="../js/readingTime.js"></script>
    <script src="../js/incubator.js"></script>

  </body>
</html>